<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Member Label Print</title>
</head>
<body>
<h1>Scan your fob to continue</h1>
<script type="text/javascript">
    let fob = '';
    document.onkeyup = function (ev) {
      ev.stopPropagation();
      ev.preventDefault();
      if (ev.key === 'Enter') {
          // submit fob
          const url = `/print?fob=${Number(fob)}`; // strip leading zeros
          fob = '';

          console.log("Request: ", url);
          fetch(url, {
              method: "POST",
          }).then(r => r.text()).then(val => {
              console.log("Response: ", val);
          }).catch(err => {
              console.error(err);
              alert("There was an error. Please contact a director if the issue persists.");
          });
      } else {
          // Read fob (if valid number)
          const n = Number(ev.key);
          if (Number.isFinite(n) && n >= 0 && n <= 9) {
              fob += ev.key;
          }
      }
    };
</script>
</body>
</html>